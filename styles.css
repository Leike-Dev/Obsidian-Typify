/* ==========================================================================
   Typify Plugin - Obsidian Styles
   ========================================================================== */

/* Base styling - using more specific selector to override Obsidian defaults */
.multi-select-pill.custom-status-icon-pill {
    /* ============================================
       CUSTOM VARIABLES - Edit these to control sizing
       ============================================ */
    --icon-size: 14px;
    /* Icon width and height */
    --icon-gap: 6px;
    /* Space between icon and text */
    --pill-font-size: inherit;
    /* Text size (inherit = use default) */
    --pill-padding-x: 6px;
    /* Horizontal padding */
    --pill-padding-y: 2px;
    /* Vertical padding */

    /* Theme Integration */
    --pill-background: var(--pill-light-bg);
    --pill-color: var(--pill-light-text);
    --pill-background-hover: var(--pill-light-bg-hover);
    --pill-color-hover: var(--pill-light-text-hover);
    --pill-border-color: var(--pill-light-border);

    /* Layout */
    display: inline-flex !important;
    align-items: center !important;
    padding: var(--pill-padding-y) var(--pill-padding-x) !important;
    line-height: 1.2 !important;
    /* Custom styled border */
    border: 1px solid var(--pill-border-color) !important;
    box-shadow: none !important;
    border-radius: var(--pill-radius, var(--tag-radius, 14px)) !important;
    background-color: var(--pill-background) !important;
    color: var(--pill-color) !important;
    /* No transition on base state to avoid animation when MutationObserver reprocesses */
}

/* Dark Mode Overrides */
.theme-dark .multi-select-pill.custom-status-icon-pill {
    --pill-background: var(--pill-dark-bg);
    --pill-color: var(--pill-dark-text);
    --pill-background-hover: var(--pill-dark-bg-hover);
    --pill-color-hover: var(--pill-dark-text-hover);
    --pill-border-color: var(--pill-dark-border);
}

/* Hover state - transition only applies here */
.multi-select-pill.custom-status-icon-pill:hover {
    background-color: var(--pill-background-hover) !important;
    color: var(--pill-color-hover) !important;
    border-color: var(--pill-border-color) !important;
    transition: background-color 0.15s ease, color 0.15s ease, border-color 0.15s ease !important;
}

/* Remove button (X) - uses status color */
.multi-select-pill.custom-status-icon-pill .multi-select-pill-remove-button {
    color: var(--pill-color) !important;
    opacity: 0.7;
    margin-left: 2.5px;
}

.multi-select-pill.custom-status-icon-pill .multi-select-pill-remove-button:hover {
    color: var(--pill-color-hover) !important;
    opacity: 1;
    transition: color 0.15s ease, opacity 0.15s ease !important;
}

/* Pill content - uses custom variables */
.multi-select-pill.custom-status-icon-pill .multi-select-pill-content {
    display: inline-flex;
    align-items: center;
    font-size: var(--pill-font-size);
}

/* Icon - uses custom variables */
.multi-select-pill.custom-status-icon-pill .multi-select-pill-content::before {
    content: '';
    display: var(--pill-icon-display, none);
    width: var(--icon-size);
    height: var(--icon-size);
    margin-right: var(--icon-gap);
    flex-shrink: 0;
    background-color: currentColor;
    mask-size: contain;
    mask-repeat: no-repeat;
    mask-position: center;
    -webkit-mask-size: contain;
    -webkit-mask-repeat: no-repeat;
    -webkit-mask-position: center;
    mask-image: var(--pill-icon-url);
    -webkit-mask-image: var(--pill-icon-url);
    border-radius: 0;
}

/* ==========================================================================
   SETTINGS TAB STYLES
   ========================================================================== */

.csi-settings-container {
    padding: 32px 48px;
    width: 100%;
    min-width: 400px;
    box-sizing: border-box;
    overflow-y: auto;
    scrollbar-gutter: stable;
}

/* Header */
.csi-settings-header {
    margin-bottom: var(--size-4-6);
}

.csi-settings-header h2 {
    margin: 0;
    font-size: 24px;
    font-weight: 700;
    letter-spacing: -0.5px;
}

.csi-version {
    font-size: 12px;
    color: var(--text-muted);
    font-weight: normal;
    margin-left: 8px;
    vertical-align: middle;
    background: var(--background-modifier-form-field);
    padding: 2px 6px;
    border-radius: 4px;
}

/* Section Headers (unified style for all section titles) */
h3.csi-section-header,
h3.csi-status-list-header {
    font-size: var(--font-ui-medium);
    font-weight: 600;
    color: var(--text-normal);
    margin-top: 32px !important;
    margin-bottom: 16px;
}

.csi-status-item {
    display: flex;
    flex-direction: column;
    border-radius: var(--setting-items-radius);
    background-color: var(--setting-items-background);
    padding: 0;
    margin-bottom: var(--size-4-2);
    border: var(--setting-items-border-width) solid var(--setting-items-border-color);
    overflow: hidden;
    transition: all 0.2s ease;
    box-sizing: border-box;
}

.csi-status-item:hover {
    border-color: var(--interactive-accent);
}

/* Accordion Header */
.csi-status-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--setting-items-padding);
    cursor: pointer;
    background-color: var(--background-secondary);
    user-select: none;
}

.csi-status-header:hover {
    background-color: var(--background-secondary-alt);
}

.csi-status-name {
    font-weight: 600;
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.csi-status-preview-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    display: inline-block;
}

.csi-status-arrow {
    transition: transform 0.2s ease;
    color: var(--text-muted);
}

.csi-status-item.is-open .csi-status-arrow {
    transform: rotate(180deg);
}

/* Accordion Body */
.csi-status-body {
    display: none;
    padding: 0;
    border-top: 1px solid transparent;
}

.csi-status-item.is-open .csi-status-body {
    display: block;
    padding: var(--setting-items-padding);
    border-top-color: var(--background-modifier-border);
}

.csi-controls-list {
    display: flex;
    flex-direction: column;
    gap: var(--size-4-2);
    margin-bottom: var(--size-4-4);
}

.csi-control-card {
    display: flex;
    align-items: center;
    gap: var(--size-4-4);
    border-radius: var(--setting-items-radius);
    background-color: var(--setting-items-background);
    padding: var(--setting-items-padding);
    border: var(--setting-items-border-width) solid var(--setting-items-border-color);
}

.csi-control-card .csi-card-info {
    flex: 1;
    min-width: 0;
}

.csi-preview-card {
    display: flex;
    gap: 8px;
    padding: var(--setting-items-padding);
    border-radius: var(--setting-items-radius);
    background-color: var(--setting-items-background);
    border: var(--setting-items-border-width) solid var(--setting-items-border-color);
    margin-bottom: var(--size-4-4);
}

/* Preview Wrappers for Theme Simulation */
.csi-preview-wrapper {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 16px;
    border-radius: 8px;
    border: 1px solid var(--background-modifier-border);
    gap: 8px;
}

.csi-preview-label {
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    opacity: 0.7;
    margin-bottom: 4px;
}

/* Adaptive Preview Backgrounds */

/* Default fallback colors */
.csi-preview-light {
    background-color: #ffffff;
    color: #202020;
}

.csi-preview-dark {
    background-color: #1e1e1e;
    color: #dcddde;
}

/* When in Light Mode: Light preview uses real note color */
.theme-light .csi-preview-light {
    background-color: var(--background-primary);
    border-color: var(--background-modifier-border);
}

/* When in Dark Mode: Dark preview uses real note color */
.theme-dark .csi-preview-dark {
    background-color: var(--background-primary);
    border-color: var(--background-modifier-border);
}

/* Ensure actions are separated */
.csi-actions {
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    padding-top: 16px;
    border-top: 1px solid var(--background-modifier-border);
}

.csi-delete-btn {
    color: var(--text-error);
    transition: all 0.2s ease;
}

.csi-delete-btn.csi-delete-confirm {
    background-color: var(--background-modifier-error);
    color: var(--text-on-accent);
    border-color: var(--background-modifier-error);
}

.csi-delete-btn.csi-delete-confirm:hover {
    background-color: var(--background-modifier-error-hover);
    border-color: var(--background-modifier-error-hover);
    box-shadow: 0 0 0 1px var(--background-modifier-error-hover);
}

/* Preview pills */
.csi-preview-pill {
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 12px;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    gap: 4px;
}

/* Inputs within settings */
.csi-input-text {
    width: 150px;
}

/* Control area (right side of control cards) */
.csi-control-area {
    text-align: end;
    display: flex;
    justify-content: flex-end;
    align-items: center;
    gap: var(--size-4-2);
}

/* Icon preview */
.csi-icon-preview {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
}

/* Color picker - native Obsidian style */
.csi-control-card input[type="color"] {
    -webkit-appearance: none;
    appearance: none;
    width: calc(var(--swatch-width) + 2px);
    height: calc(var(--swatch-width) + 2px);
    aspect-ratio: 1;
    background-color: transparent;
    border: 2px solid transparent;
    border-radius: 50%;
    cursor: var(--cursor);
    padding: 0px;
}

.csi-control-card input[type="color"]:hover,
.csi-control-card input[type="color"]:focus {
    border-color: var(--background-modifier-border);
}

.csi-control-card input[type="color"]::-webkit-color-swatch-wrapper {
    padding: 0;
    width: 100%;
    height: 100%;
    border-radius: 50%;
}

.csi-control-card input[type="color"]::-webkit-color-swatch {
    border: none;
    width: 100%;
    height: 100%;
    border-radius: 50%;
}

.csi-control-card input[type="color"]::-moz-color-swatch {
    border: none;
    width: 100%;
    height: 100%;
    border-radius: 50%;
}

/* ==========================================================================
   ICON PICKER MODAL
   ========================================================================== */

/* Icon Picker Button */
.csi-icon-picker-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    padding: 0;
    cursor: pointer;
}

.csi-btn-remove-icon:hover {
    color: var(--text-error);
}


/* Icon Suggestion in Modal */
.csi-icon-suggestion {
    display: flex;
    align-items: center;
    gap: 10px;
}

.csi-icon-suggestion-icon {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.csi-icon-suggestion-icon svg {
    width: 18px;
    height: 18px;
}

.csi-icon-suggestion-name {
    flex: 1;
    font-family: var(--font-monospace);
    font-size: 13px;
}

.csi-icon-recent-badge {
    font-size: 8px;
    color: var(--interactive-accent);
}

/* Custom icon badge in icon picker */
.csi-icon-custom-badge {
    font-size: 10px;
    font-weight: 600;
    color: var(--text-on-accent);
    background-color: var(--interactive-accent);
    padding: 1px 6px;
    border-radius: 4px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Bases Cards View - uses custom variables */
.bases-view .bases-cards-container .bases-cards-property .value-list-element.custom-status-icon-value {
    /* Theme Integration */
    --pill-background: var(--pill-light-bg);
    --pill-color: var(--pill-light-text);
    --pill-background-hover: var(--pill-light-bg-hover);
    --pill-color-hover: var(--pill-light-text-hover);
    --pill-border-color: var(--pill-light-border);

    background: var(--pill-background) !important;
    color: var(--pill-color) !important;
    border: 1px solid var(--pill-border-color) !important;
    border-radius: var(--pill-radius, 4px) !important;
    padding: 2px 6px !important;
    display: inline-flex !important;
    align-items: center !important;
    vertical-align: middle !important;
    gap: 4px !important;
}

.bases-view .bases-cards-container .bases-cards-property .value-list-element.custom-status-icon-value:hover {
    background: var(--pill-background-hover) !important;
    color: var(--pill-color-hover) !important;
}

/* Dark Mode Overrides for Bases Cards View */
.theme-dark .bases-view .bases-cards-container .bases-cards-property .value-list-element.custom-status-icon-value {
    --pill-background: var(--pill-dark-bg);
    --pill-color: var(--pill-dark-text);
    --pill-background-hover: var(--pill-dark-bg-hover);
    --pill-color-hover: var(--pill-dark-text-hover);
    --pill-border-color: var(--pill-dark-border);
}

/* Icon for Bases Cards View */
.bases-view .bases-cards-container .bases-cards-property .value-list-element.custom-status-icon-value::before {
    content: '';
    display: var(--pill-icon-display, none);
    width: 14px;
    height: 14px;
    min-width: 14px;
    mask-image: var(--pill-icon-url);
    -webkit-mask-image: var(--pill-icon-url);
    -webkit-mask-size: contain;
    mask-size: contain;
    -webkit-mask-repeat: no-repeat;
    mask-repeat: no-repeat;
    -webkit-mask-position: center;
    mask-position: center;
    background-color: currentColor;
}

/* Settings Header - version number inline with title */
.csi-settings-container>.setting-item-heading:first-child .setting-item-info {
    display: flex;
    flex-direction: row;
    align-items: baseline;
    gap: 8px;
}

.csi-settings-container>.setting-item-heading:first-child .setting-item-name {
    overflow: visible;
    text-overflow: unset;
    white-space: nowrap;
    flex-shrink: 0;
}

.csi-settings-container>.setting-item-heading:first-child .setting-item-description {
    font-weight: var(--font-normal);
    font-size: var(--font-ui-small);
    color: var(--text-muted);
    white-space: nowrap;
}

/* Mobile fallback */
@media (max-width: 300px) {
    .csi-settings-container>.setting-item-heading:first-child .setting-item-info {
        flex-direction: column;
    }
}


.csi-experimental-warning {
    background-color: hsla(35, 80%, 55%, 0.12);
    border: 1px solid hsla(35, 70%, 50%, 0.3);
    border-radius: 8px;
    padding: 12px 16px;
    margin: 8px 0 12px 0;
}

.theme-dark .csi-experimental-warning {
    background-color: hsla(30, 70%, 45%, 0.15);
    border-color: hsla(30, 60%, 45%, 0.25);
}

.csi-experimental-warning .warning-text {
    margin: 0;
    color: var(--text-muted);
    font-size: var(--font-ui-small);
}

/* Custom icon preview sizing */
.csi-icon-suggestion-icon svg {
    max-width: 18px;
    max-height: 18px;
}

/* ==========================================================================
   STYLE MANAGER MODAL
   ========================================================================== */

.csi-manager-modal {
    padding: 0;
}

/* Search input */
.csi-manager-search-container {
    margin-bottom: var(--size-4-3);
}

.csi-manager-search {
    width: 100%;
    padding: var(--size-4-2) var(--size-4-3);
    border: 1px solid var(--background-modifier-border);
    border-radius: var(--input-radius);
    background: var(--background-modifier-form-field);
    color: var(--text-normal);
    font-size: var(--font-ui-small);
    outline: none;
    box-sizing: border-box;
}

.csi-manager-search:focus {
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
}

/* Count label */
.csi-manager-count {
    font-size: var(--font-ui-smaller);
    color: var(--text-muted);
    margin-bottom: var(--size-4-2);
}

/* Group header separator */
.csi-manager-group-header {
    display: flex;
    align-items: center;
    gap: var(--size-4-2);
    font-size: var(--font-ui-smaller);
    font-weight: 600;
    color: var(--text-muted);
    margin-top: var(--size-4-2);
    margin-bottom: var(--size-4-1);
    text-transform: capitalize;
    white-space: nowrap;
}

.csi-manager-group-header:first-child {
    margin-top: 0;
}

.csi-manager-group-header::after {
    content: '';
    flex: 1;
    border-bottom: 1px solid var(--background-modifier-border);
}

/* Scrollable list */
.csi-manager-list {
    max-height: 400px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: var(--size-4-1);
    padding-bottom: var(--size-4-4);
}

/* Individual item card */
.csi-manager-item {
    display: flex;
    align-items: center;
    gap: var(--size-4-3);
    padding: var(--size-4-2) var(--size-4-3);
    border-radius: var(--radius-s);
    border: 1px solid var(--background-modifier-border);
    background: var(--background-secondary);
    transition: border-color 0.15s ease;
    position: relative;
}

.csi-manager-item:hover {
    border-color: var(--interactive-accent);
}

/* Item info (left side: dot + text) */
.csi-manager-item-info {
    display: flex;
    align-items: center;
    gap: var(--size-4-2);
    flex: 1;
    min-width: 0;
}

/* Color dot */
.csi-manager-color-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    flex-shrink: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
}

.theme-dark .csi-manager-color-dot {
    border-color: rgba(255, 255, 255, 0.15);
}

/* Text block */
.csi-manager-item-text {
    flex: 1;
    min-width: 0;
}

.csi-manager-item-name {
    font-weight: 600;
    font-size: var(--font-ui-small);
    color: var(--text-normal);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Metadata row */
.csi-manager-meta {
    font-size: var(--font-ui-smaller);
    color: var(--text-muted);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Icon preview in metadata */
.csi-manager-icon-meta {
    display: inline-flex;
    align-items: center;
    gap: 2px;
}

.csi-manager-icon-preview {
    display: inline-flex;
    align-items: center;
    width: 14px;
    height: 14px;
}

.csi-manager-icon-preview svg {
    width: 14px;
    height: 14px;
}

/* Preview pill */
.csi-manager-preview-pill {
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 11px;
    font-weight: 500;
    white-space: nowrap;
    flex-shrink: 0;
}

/* Action buttons */
.csi-manager-actions {
    display: flex;
    gap: var(--size-4-1);
    flex-shrink: 0;
}

.csi-manager-delete-btn {
    color: var(--text-muted);
    transition: color 0.15s ease;
}

.csi-manager-delete-btn:hover {
    color: var(--text-error);
}

/* Inline delete confirmation */
.csi-manager-confirm {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--size-4-3);
    background: var(--background-secondary);
    border-radius: var(--radius-s);
    z-index: 1;
    padding: var(--size-4-2) var(--size-4-3);
}

.csi-manager-confirm-text {
    font-size: var(--font-ui-small);
    font-weight: 500;
    color: var(--text-normal);
}

.csi-manager-confirm-btns {
    display: flex;
    gap: var(--size-4-1);
}

/* Empty state */
.csi-manager-empty {
    text-align: center;
    color: var(--text-muted);
    font-size: var(--font-ui-small);
    padding: var(--size-4-8) var(--size-4-4);
}
